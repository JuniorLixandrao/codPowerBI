USE [NOME DO BANCO PARA CRIAR O ARMAZENAMENTO]
GO
/****** Object:  StoredProcedure [DADOS DA PROC(ALTERA AUTOMATICO)]    Script Date: 03/04/2025 09:15:46 ******/

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

--RODAR PRIMEIRA VEZ
CREATE PROC [dbo].[01_NOME DA BULK CRIADA]

--APOS CRIAÇÃO
ALTER PROC [dbo].[NOME DA BULK CRIADA]

AS  
BEGIN

SELECT *
INTO #tmpExcelData01/
FROM OPENROWSET(
    'Microsoft.ACE.OLEDB.12.0',
    'Excel 12.0;Database=\\CAMINHO DO ARQUIVO\NOME DO ARQUIVO.xlsx;HDR=YES;IMEX=1',
    'SELECT * FROM [-NOME ABA PLANILHA-$]');

----Agora insira os dados da tabela temporária para a tabela final

--DICA E BOA PRATICA: CRIAR TABELA ENUMERADA, ASSIM COM A TABELA TEMPORARIA

IF OBJECT_ID ('[NOME DO BANCO PARA CRIAR O ARMAZENAMENTO].[dbo].[01_NOME DA TABELA ARMAZENADA]','U') IS NOT NULL
DROP TABLE [NOME DO BANCO PARA CRIAR O ARMAZENAMENTO].[dbo].[01_NOME DA TABELA ARMAZENADA]

SELECT * 
INTO [NOME DO BANCO PARA CRIAR O ARMAZENAMENTO].[dbo].[01_NOME DA TABELA ARMAZENADA]
FROM #tmpExcelData01;

--Limpar a tabela temporária
DROP TABLE #tmpExcelData01;

SELECT * FROM [NOME DO BANCO PARA CRIAR O ARMAZENAMENTO].[dbo].[01_NOME DA TABELA ARMAZENADA]

END
